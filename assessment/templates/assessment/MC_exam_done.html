{% extends 'base.html' %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-auto">
                <a href="{% url 'assessment:student' %}" class="btn btn-link" onclick="appendSpinOnClick(this)" title="back to assessment"><i class="fa fa-chevron-left mr-1"></i>Back </a>
            </div>
            <div class="col-auto mx-auto">
                <h4 class="text-monospace">{{ student_script.course }} {{ student_script.question_group.get_title_display }} Scripts</h4>
                <hr>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-8 mx-auto my-3">
                <div class="card-group">
                    <div class="card">
                        <div class="card-body">
                            <p class="card-title">Your Score</p>
                            <h1 class="text-center mt-2 display-4 " title="You scored {{ score|floatformat }}">{{ score|floatformat }} / {{ question_group.total_marks }}</h1>
                            <p class="form-text text-center"><b>{{ correct_answers_num }}</b> out of  <b>{{ question_group.question_set.count }}</b> questions</p>
                        </div>
                            <div class="d-flex justify-content-end p-2 ">
                                {% if wrong_answers_num %}
                                    <small class="text-muted">wrong answered questions are {{ wrong_answers_num }}</small>
                                {% elif wrong_answers_num == 0 and correct_answers_num == total_questions_num %}
                                    <small class="text-success">you scored all - {{ wrong_answers_num }} questions</small>
                                {% endif %}
                            </div>
                    </div>
                    <div class="card">
                        <div class="card-body">
                            <p class="card-title">Detail</p>
                            <div class="table-responsive">
                                <table class="table m-0">
                                <tr>
                                    <td>Questions Answered</td>
                                    <td>
                                        {% if un_answered_option %}
                                            <ul class="list-group list-group-horizontal">
                                                <li class="list-group-item list-group-item-info" title="{{ answered_option }} Attended">{{ answered_option }}</li>
                                                <li class="list-group-item list-group-item-warning" title="{{ un_answered_option }} Unattended">{{ un_answered_option }}</li>
                                            </ul>
                                        {% else %}
                                            <span>All ({{ total_questions_num }})</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <td>Duration</td>
                                    <td>
                                        {{ question_group.preference.duration|time:"H\h\r\s : i\m\s" }}
                                    </td>
                                </tr>
                                <tr>
                                    <td title="correct and wrong answers">Answers</td>
                                    <td>
                                        <ul class="list-group list-group-horizontal w-100">
                                            <li class="list-group-item list-group-item-success w-50" title="{{ correct_answers_num }} Corrects">{{ correct_answers_num }}</li>
                                            <li class="list-group-item list-group-item-danger w-50" title="{{ wrong_answers_num }} Wrongs">{{ wrong_answers_num }}</li>
                                        </ul>
                                    </td>
                                </tr>
                            </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <p>{{ request.user.get_short_name }}, your answer scripts</p>
                <ul class="list-group list-group-horizontal-md small text-center">
                    <li class="list-group-item "><b>Table Guide</b></li>
                    <li class="list-group-item list-group-item-primary">Answered Correct</li>
                    <li class="list-group-item list-group-item-danger">Answered Wrong</li>
                    <li class="list-group-item list-group-item-success">Correct Answer</li>
                </ul>
                <hr>
            </div>
        </div>

        <div class="row">
            <div class="col-12 ">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <tr>
                            <th>#</th>
                            <th>Question</th>
                            <th>Option</th>
                            <th>Score Mark</th>
                        </tr>
                        {% for question_anwser in student_script.studentmultichoiceanswer_set.all %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>
                                    {{ question_anwser.question }}
                                </td>
                                <td>
                                    <ul class="list-group">
                                        {% for option in question_anwser.question.multichoicequestion_set.all %}
                                            {% if option.is_answer_option and option == question_anwser.selected_option %}
                                                <li class="list-group-item list-group-item-primary" title="you had correct">{{ option.option }}</li>
                                            {% elif option.is_answer_option %}
                                                <li class="list-group-item list-group-item-success" title="this is the correct answer. You missed">{{ option.option }}</li>
                                            {% elif option == question_anwser.selected_option %}
                                                <li class="list-group-item list-group-item-danger" title="you had wrong">{{ option.option }}</li>
                                            {% else %}
                                                <li class="list-group-item">{{ option.option }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>{{ question_anwser.question.max_mark }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>


    </div>
{% endblock %}